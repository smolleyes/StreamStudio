module.exports = binding;

function binding (name, renderer) {
  return create;

  function create (parent, context) {
    return construct({
      parent: parent,
      context: context
    });
  }

  function construct (options) {
    var elements = select(options.parent, name);
    var i = -1;
    var len = elements.length;

    while (++i < len) {
      if (elements.indexOf(elements[i], i + 1) > -1) {
        continue;
      }

      renderer(elements[i], options.context);
    }
  }
}

function select (parent, attr) {
  var selector = '*[' + attr + ']';
  var result = [];

  if (parent.hasAttribute && parent.hasAttribute(attr)) {
    result.push(parent);
  }

  result.push.apply(result, parent.querySelectorAll('*[' + attr + ']'));

  return result;
}
